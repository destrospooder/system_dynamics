{"title":"Frequency Response","markdown":{"headingText":"Frequency Response","containsRefs":false,"markdown":"\n## Preface {-}\n\nJust as the impulse response characterizes all systems in the time domain, the **frequency response** characterizes all systems in the frequency domain. The frequency response is a linear system's steady-state response to sinusoidal inputs. \n\n\n\nMore broadly, the frequency response describes how a system responds to different frequencies of input signals. Understanding the frequency response is crucial for designing and analyzing systems like filters and amplifiers. It also plays a critical role in understanding the behavior of natural systems such as the human ear, which responds differently to different frequencies of sound waves.\n\n## That Hertz!\n\nSo what exactly makes sinusoidal inputs so interesting?  \n\n\n\nWell, plugging a sinusoidal input into an LTI system yields a sinusoidal response of the same frequency (in the steady-state). However, the response *may* differ in amplitude and phase.\n\nAs such, it's common to use the phasor representation of a sinusoid for frequency response techniques, where the magnitude of the complex number is the amplitude of the wave, and the angle of the complex number is the phase. Say our input is $u(t) = A \\sin(\\omega t)$. We can express this in terms of complex exponentials as follows:\n\n\n$$u(t) = A \\sin(\\omega t) = \\frac{A}{2i} \\left(e^{i\\omega t} - e^{-i \\omega t} \\right)$$\n\nUsing the convolution integral, let's solve for a potential $y(t)$.\n\n\n\\begin{align*}\ny(t) &= \\int_{0^-}^t h(\\tau) u(t-\\tau) \\, d\\tau \\\\\n&= \\frac{A}{2i} \\int_{0^-}^t h(\\tau) \\left(e^{i\\omega (t - \\tau)} - e^{-i \\omega (t - \\tau)} \\right) \\, d\\tau = \\frac{A}{2i} \\int_{0^-}^t h(\\tau) \\left(e^{i\\omega t} e^{-i\\omega \\tau} - e^{-i\\omega t} e^{i\\omega \\tau} \\right) \\, d\\tau \\\\\n&= \\frac{A}{2i} \\int_{0^-}^t h(\\tau) \\left(e^{i\\omega t} e^{-i\\omega \\tau} \\right) \\, d\\tau - \\frac{A}{2i} \\int_{0^-}^t h(\\tau) \\left(e^{-i\\omega t} e^{i\\omega \\tau} \\right) \\, d\\tau \\\\\n&= \\frac{A}{2i} e^{i\\omega t} \\int_{0^-}^t h(\\tau)  e^{-i\\omega \\tau} \\, d\\tau - \\frac{A}{2i} e^{-i\\omega t} \\int_{0^-}^t h(\\tau) e^{i\\omega \\tau} \\, d\\tau\\\\\n&= \\frac{A}{2i} \\left(e^{i\\omega t}H(s) - e^{-i\\omega t} H(-s) \\right)\n\\end{align*}\n\nWe define the **frequency response function** $H(i\\omega)$ as the transfer function $H(s)$ evaluated at $s=i\\omega$. \n\n\n$$\\left[\\frac{A}{2i} \\left(e^{i\\omega t}H(s) - e^{-i\\omega t} H(-s) \\right) \\right]_{s = i \\omega} = \\frac{A}{2i} \\left( H(i\\omega) e^{i\\omega t} - H(-i \\omega)  e^{-i\\omega t} \\right)$$\n\n\n\nNotice that since the Laplace transform of the impulse response is the transfer function of a system, and the frequency response function $H(i\\omega)$ is complex, we can represent it as the product of a magnitude $M$ and an exponential with phase $\\varphi$:\n\n\n$$H(i\\omega) = M e^{i\\varphi}$$\n\nwhere $M = |H(i\\omega)|$ and $\\varphi = \\measuredangle H(i\\omega)$. We rewrite $y(t)$ as:\n\n\n$$y(t) = \\frac{A}{2i} \\left(M e^{i\\omega t + \\varphi} - M e^{-i \\omega t - \\varphi} \\right) = AM \\sin(\\omega t + \\varphi)$$\n\nThus, if a system has a transfer function representation of $H(s)$, a sinusoidal input with amplitude $A$ will \"become\" a sinusoidal output with magnitude $AM$, shifted by phase angle $\\varphi$.\n\n\n\nLet's be a tad less abstract now. The frequency response is characterized as the magnitude/gain $M(\\omega)$ and the phase $\\varphi(\\omega)$. The magnitude is defined as the ratio of the output wave's amplitude to the input wave's amplitude, and the phase is defined as the offset of the output signal compared to the input signal.\n\n\n\nA positive magnitude means that the output wave is scaled up/magnified from the input wave. A negative magnitude means that the output wave is scaled down/contracted from the input wave. A positive phase means that the output wave leads the input wave, and a negative phase means that the output wave lags from the input wave.^[There are opposite conventions for the sign of phase in controls and vibrations. This is because vibrations engineers usually get things wrong.]\n\n## Intermezzo - Another Quick Dive into Complex Analysis {-}\n\nThinking of complex numbers as vectors is great when trying to establish the notion of a \"magnitude\" (or more commonly in complex analysis textbooks, the modulus) of a complex number. The **magnitude** $|z|$ of a complex number $z = a + bi$ is defined as:\n\n\n$$|z| = |a+bi| = \\sqrt{a^2 + b^2}$$\n\nA useful result for this course is that the magnitude of the product/quotient of complex numbers is equal to the product/quotient of the modulus of the complex numbers. For example:\n\n$$z = \\frac{3 + i}{4 + 2i} \\qquad \\qquad |z| = \\left|\\frac{3 + i}{4 + 2i} \\right| = \\frac{\\sqrt{3^2+1^2}}{\\sqrt{4^2+2^2}} = \\sqrt{\\frac{10}{20}} = \\sqrt{\\frac{1}{2}} = \\frac{\\sqrt{2}}{2}$$\n\nThe \"phase\" $\\varphi$ (or more commonly in complex analysis textbooks, the argument) of a complex number is the polar angle from the positive real axis to the vector representation of $z$ in the complex plane.\n\n\n\nSo say we're interested in finding the phase of $z = 3 + i$.\n\nIt's clear that the phase $\\varphi$ is equal to $\\tan^{-1} \\frac{1}{3}$. \n\n\n\n(TALK ABOUT PRINCIPLE ARGUMENTS AND DOMAIN RESTRICTIONS)\n\n\n\nAnother useful result for this course is that the phase of the product of two complex numbers is equal to the sum of the phase of the complex numbers. (Relatedly, the phase of the quotient of two complex numbers is equal to the difference of the phase of the complex numbers.)\n\n\n\nSay we're analyzing the system $\\dot{y} + 3y = u$. What's the response to the sinusoidal input $u = A \\cos(\\omega t)$?\n\n\n\nThe transfer function (and thus, the frequency response function) of the system is trivial to find:\n\n$$H(s) = \\frac{1}{s+3} \\qquad \\qquad H(i\\omega) = \\left[H(s) \\right]_{s=i\\omega} = \\frac{1}{i\\omega + 3}$$\n\n$$M = \\left|H(i\\omega) \\right| = \\left|\\frac{1}{i\\omega + 3} \\right| = \\frac{1}{\\sqrt{\\omega^2 + 9}}$$ \n$$\\varphi = \\measuredangle H(i\\omega) = -\\tan^{-1} \\left(\\frac{\\omega}{3} \\right)$$\n\n\nNote that in the preface (and a few other times) that I specified that the frequency response only shows a system's **steady-state** response. The frequency response is only applicable to the steady-state response of a system, and it does not provide information about the system's transient behavior.\n\n\n\n## It's Pronounced Boh-dee\n\n(TALK ABOUT BODE AT SOME POINT)\n\nHow about a damped mass-spring system? Here's the equation of motion of a hypothetical system:\n\n\n$$\\ddot{q}+2\\zeta \\omega_n \\dot{q} + \\omega_n^2 q = \\omega_n^2 u$$\n\nTo find the transfer function, we take the Laplace transform of both sides (assuming zero initial conditions) and get:\n\n$$(s^2+2\\zeta\\omega_n s + \\omega_n^2) Q = \\omega_n^2 U$$\n$$H = \\frac{Q}{U} = \\frac{\\omega_n^2}{s^2+2\\zeta\\omega_n s + \\omega_n^2}$$\n\n(LOOK AT INITIAL RESPONSE AND GO TO PLOTTING WITH PIECEWISE LINEARS)\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true,"format-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"ch6.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.3.353","bibliography":["references.bib"],"markdown_extensions":["admonition"],"theme":{"light":"flatly","dark":"darkly"}},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"ch6.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"markdown_extensions":["admonition"],"documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}