<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>System Dynamics - 3&nbsp; Our Second Order of Business</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./ch4.html" rel="next">
<link href="./ch2.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./ch3.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Our Second Order of Business</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">System Dynamics</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Information</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Course Motivation and Overview</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The First Order</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch3.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Our Second Order of Business</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">An Engineering Student’s Butchering of Ma326</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">A Mishmash of Modeling Concepts</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Frequency Response</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ch7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Dynamic Behavior and Linear Systems</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chaux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Auxiliary Topics</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#preface" id="toc-preface" class="nav-link active" data-scroll-target="#preface">Preface</a></li>
  <li><a href="#mass-and-spring" id="toc-mass-and-spring" class="nav-link" data-scroll-target="#mass-and-spring"><span class="header-section-number">3.1</span> Mass and Spring</a></li>
  <li><a href="#leveraging-the-discriminant" id="toc-leveraging-the-discriminant" class="nav-link" data-scroll-target="#leveraging-the-discriminant"><span class="header-section-number">3.2</span> Leveraging the Discriminant</a></li>
  <li><a href="#pole-plots" id="toc-pole-plots" class="nav-link" data-scroll-target="#pole-plots"><span class="header-section-number">3.3</span> Pole Plots</a></li>
  <li><a href="#the-dominant-pole-approximation" id="toc-the-dominant-pole-approximation" class="nav-link" data-scroll-target="#the-dominant-pole-approximation"><span class="header-section-number">3.4</span> The Dominant Pole Approximation</a></li>
  <li><a href="#the-tank-revisited-inertia" id="toc-the-tank-revisited-inertia" class="nav-link" data-scroll-target="#the-tank-revisited-inertia"><span class="header-section-number">3.5</span> The Tank, Revisited (Inertia)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Our Second Order of Business</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="preface" class="level2 unnumbered">
<h2 class="unnumbered anchored" data-anchor-id="preface">Preface</h2>
<p>First order systems aren’t that interesting. They exhibit a certain…simplicity in their response to a step input, characterized by pure exponential behavior. (However, it’s important to appreciate the fundamental nature of this behavior, as it lays the foundation for understanding more complex dynamic systems.)</p>
<p>Nevertheless, first order systems lack the necessary components to sustain oscillatory behavior…which really stinks because oscillation represents a fundamental behavior observed in many natural and engineered systems.</p>
<p>Second order systems, on the other hand, <em>can</em> oscillate by themselves. <a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<p>Mass-spring systems are pretty versatile models for a really wide range of phenomena (as long as you use enough mass-spring systems). They’re really nice because having a good understanding of ONE mass-spring system provides us with the intuition for more complicated systems. While mass-spring systems may not capture <em>all</em> the intricacies and complexities of real-world phenomena, they serve as an invaluable tool for providing a framework for understanding a LOT of systems.</p>
</section>
<section id="mass-and-spring" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="mass-and-spring"><span class="header-section-number">3.1</span> Mass and Spring</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/3_msd.png" class="img-fluid figure-img" style="width:65.0%"></p>
</figure>
</div>
<p>Say we have a mass-spring system where a mass <span class="math inline">\(m\)</span> is attached to a wall with a spring with spring constant <span class="math inline">\(k\)</span> and a dashpot with damping coefficient <span class="math inline">\(b\)</span>, as pictured above. (Gravity isn’t “turned on” in this scenario.) The equation of motion for a positive displacement <span class="math inline">\(q\)</span> is:</p>
<p><span class="math display">\[ ma = \sum F \]</span> <span class="math display">\[m\ddot{q} = -kq - b\dot{q}\]</span> <span class="math display">\[m\ddot{q} + b\dot{q} + kq = 0\]</span></p>
<p>This is a linear differential equation, so we’re able to solve this pretty easily. We’ll assume a solution of the form <span class="math inline">\(q(t) = Ae^{st}\)</span>, where <span class="math inline">\(A\)</span> is a constant to be determined. <span class="math display">\[m \left( s^2 Ae^{st} \right) + b \left( sAe^{st} \right)+ k \left(Ae^{st} \right)= 0\]</span></p>
<p>Cancelling out the common term <span class="math inline">\(Ae^{st}\)</span>, we get:</p>
<p><span class="math display">\[ms^2 + bs + k = 0\]</span></p>
<p>This is known as the <strong>characteristic (or auxiliary) equation</strong>. We can solve this quadratic equation to find the values of <span class="math inline">\(s\)</span>, which are also known as the <strong>poles</strong> of the system.</p>
<p><span class="math display">\[s_{1, 2} = \frac{-b \pm \sqrt{b^2 - 4mk}}{2m}\]</span></p>
<p>We can simplify this expression further by defining the <strong>natural frequency</strong> <span class="math inline">\(\omega_n = \sqrt{\frac{k}{m}}\)</span> and the <strong>damping ratio</strong> <span class="math inline">\(\zeta = \frac{b}{2m\omega_n}\)</span>. With these definitions, the poles can be written as:</p>
<p><span class="math display">\[s_{1, 2} = -\zeta \omega_n \pm \omega_n \sqrt{\zeta^2 - 1}\]</span></p>
<p>In terms of the variables <span class="math inline">\(\zeta\)</span> and <span class="math inline">\(\omega_n\)</span>, the mass-spring equation can be rewritten as:</p>
<p><span class="math display">\[\ddot{q} + 2\zeta\omega_n \dot{q} + \omega_n^2 q = 0\]</span></p>
<p>The damping ratio <span class="math inline">\(\zeta\)</span> and the natural frequency <span class="math inline">\(\omega_n\)</span> provide important insights into the behavior of the system. However, note that the value of <span class="math inline">\(\zeta\)</span> is crucial in determining the nature of the poles of the system; it directly affects whether they’re real or imaginary.</p>
<p>Before we deal with that, though, I’ll introduce some technology from complex analysis to make our lives a bit easier.</p>
<hr>
<p>Complex analysis is the study of functions of a complex variable <span class="math inline">\(z\)</span>, where <span class="math inline">\(z\)</span> has a real component <span class="math inline">\(a\)</span> and an imaginary component <span class="math inline">\(b\)</span>. Complex numbers show up all the time in this course, whenever anything oscillates, really (like mass-spring systems or pendulums).</p>
<p>To take our first plunge into complex analysis, we need to define the <strong>imaginary unit</strong> <span class="math inline">\(i\)</span>.<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a> <span class="math inline">\(i\)</span> is a number that satisfies the equation <span class="math inline">\(i^2 = -1\)</span>. Since the square of any real number is always non-negative, there is no real number that safisties this equation. Thus, <span class="math inline">\(i\)</span> is considered an imaginary number. (Ooh!)</p>
<p>Recall from algebra that every non-constant polynomial over <span class="math inline">\(\mathbb{R}\)</span> can be factored into linear and quadratic terms. Any real quadratic can be factored into linear terms over <span class="math inline">\(\mathbb{C}\)</span>, the set of all complex numbers. As such, <span class="math inline">\(\mathbb{C}\)</span> has the roots of all polynomials over <span class="math inline">\(\mathbb{R}%\)</span>.</p>
<p>This is really special - in other words, every polynomial of degree <span class="math inline">\(n\)</span> has <span class="math inline">\(n\)</span> complex roots, counting multiplicity. This is known as the Fundamental Theorem of Algebra - it’s a nice thing to stash in the back of your head, and it’ll come back in a bit.</p>
<p>Let’s conjure up a graphical representation of these complex numbers using Cartesian coordinates, where the real numbers are represented along the <span class="math inline">\(x\)</span>-axis and the imaginary numbers along the <span class="math inline">\(y\)</span>-axis. We’ll call this the complex plane.</p>
<p>In this representation, a complex number <span class="math inline">\(z = a + bi\)</span> can be visualized as a point in the two-dimensional Cartesian plane, with the real part <span class="math inline">\(a\)</span> as the <span class="math inline">\(x\)</span>-coordinate and the imaginary part <span class="math inline">\(b\)</span> as the <span class="math inline">\(y\)</span>-coordinate.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/3_poles.png" class="img-fluid figure-img" style="width:65.0%"></p>
</figure>
</div>
<p>By plotting these complex numbers on the plane, we can observe their geometric relationships. Additionally, algebraic operations can be understood in terms of vector addition, subtraction, and scalar multiplication.</p>
<p>Complex numbers can also be interpreted in the context of polar coordinates - in polar coordinates, a complex number <span class="math inline">\(z = a + bi\)</span> is described by two quantities: the magnitude <span class="math inline">\(r\)</span> and the argument <span class="math inline">\(\theta\)</span>. The magnitude <span class="math inline">\(r\)</span> represents the distance from the origin <span class="math inline">\((0,0)\)</span> to the point representing the complex number <span class="math inline">\(z\)</span> in the complex plane. It’s calculated using the Pythagorean theorem:</p>
<p><span class="math display">\[r = \sqrt{a^2+b^2}\]</span></p>
<p>The argument, denoted as <span class="math inline">\(\theta\)</span>, represents the angle between the vector from the origin to <span class="math inline">\(z\)</span> and the positive real axis, measured counterclockwise. The argument can be determined as follows (with additional precautions depending on the quadrant):</p>
<p><span class="math display">\[\theta = \arctan \left( \frac{b}{a} \right)\]</span></p>
<p>Converting back to Cartesian coordinates is trivial.</p>
<p><span class="math display">\[a = r \cos{\theta} \qquad \qquad b = r \sin{\theta}\]</span></p>
<p>It’d be criminal to not mention Euler’s formula, which connects trigonometric functions to the complex exponential: <a href="#fn3" class="footnote-ref" id="fnref3" role="doc-noteref"><sup>3</sup></a></p>
<p><span class="math display">\[e^{i\theta} = \cos{\theta} + i \sin{\theta}\]</span></p>
<p>This result demonstrates the connection between exponentials and trigonometric functions, bringing together complex numbers, angles, and the unit circle. It also means that we can express complex numbers in the elegant form:</p>
<p><span class="math display">\[z = a+bi = r\cos{\theta} + i r \sin{\theta} = r (\cos{\theta} + i \sin{\theta}) = re^{i\theta}\]</span></p>
<p>This is <em>really</em> useful. It simplifies complex number arithmetic, enables efficient calculations of powers and roots, and provides a natural framework for solving differential equations involving complex variables.</p>
<hr>
<p>Phew. Okay, back to springs.</p>
<p>We know from our study of differential equations that <span class="math inline">\(q = e^{st}\)</span> is a solution of the equation when <span class="math inline">\(s\)</span> is a pole of the system. Let’s break each possibility down case by case.</p>
<p>When <span class="math inline">\(\zeta = 0\)</span> (or when the system is <strong>undamped</strong>), the poles are:</p>
<p><span class="math display">\[s_{1, 2} = -\zeta \omega_n \pm \sqrt{\omega_n^2 (\zeta^2 - 1)} = \pm \sqrt{-\omega_n^2 } = \pm i \omega_n\]</span></p>
<p>And the solution is: <span class="math display">\[q(t) = A_1 e^{i\omega_n t} + A_2 e^{- i \omega_n t} = A_1 (\cos(\omega_n t) + i \sin(\omega_n t)) + A_2 (\cos(\omega_n t) - i \sin(\omega_n t))\]</span> <span class="math display">\[= (A_1 + A_2) \cos(\omega_n t) + i(A_1 - A_2) \sin(\omega_n t) = C_1 \cos(\omega_n t) + C_2 \sin(\omega_n t)\]</span></p>
<p>Physically, when a mass-spring damper system is undamped, the mass will oscillate forever.</p>
<p>When we pick a damping ratio <span class="math inline">\(\zeta\)</span> between 0 and 1 (or the system is <strong>underdamped</strong>), the poles are:</p>
<p><span class="math display">\[s_{1, 2} = -\zeta \omega_n \pm \sqrt{\omega_n^2 (\zeta^2 - 1)} = -\zeta \omega_n \pm i \omega_n \sqrt{1 - \zeta^2}\]</span></p>
<p>We further consolidate the definition of these poles using two additional definitions: we define the <strong>damped frequency</strong> <span class="math inline">\(\omega_d = \omega_n \sqrt{1-\zeta^2}\)</span>, and a “growth parameter” <span class="math inline">\(\sigma = \zeta \omega_n\)</span>.<a href="#fn4" class="footnote-ref" id="fnref4" role="doc-noteref"><sup>4</sup></a> These result in a more concise representation of the poles:</p>
<p><span class="math display">\[s_{1, 2}  = - \sigma \pm i \omega_d \]</span></p>
<p>Our solution, given these poles, is: <span class="math display">\[q(t) = A_1 e^{(-\sigma + i\omega_d) t} + A_2 e^{(-\sigma - i\omega_d) t} = e^{-\sigma t} (C_1 \cos(\omega_n t) + C_2 \sin(\omega_n t))\]</span></p>
<p>Representing the solution as a product of a real exponential and a linear combination of sines and cosines allows us to characterize the exponential <strong>envelope</strong> by which the oscillation decays. An envelope is a function that outlines the extremes of a function. The figure below shows a sinusoidal wave and its upper envelope.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/3_env.png" class="img-fluid figure-img" style="width:65.0%"></p>
</figure>
</div>
<p>Notably, the time constant <span class="math inline">\(\tau\)</span> of the envelope is equal to <span class="math inline">\(1/\sigma\)</span>. Thus, we can eyeball the value of <span class="math inline">\(\sigma\)</span> based on how we’d find the time constant (the value <span class="math inline">\(63\%\)</span> less than the <span class="math inline">\(y\)</span>-intercept of the envelope). <span class="math display">\[q(t) = e^{-\sigma t} \sin(\omega_d t + \varphi)\]</span></p>
<p>Most mechanical systems tend to have a pretty low damping ratio (<span class="math inline">\(\zeta \simeq O(0.1)\)</span>),<a href="#fn5" class="footnote-ref" id="fnref5" role="doc-noteref"><sup>5</sup></a> and a good rule of thumb is that <span class="math inline">\(\omega_n = \omega_d\)</span>.</p>
<p>When <span class="math inline">\(\zeta = 1\)</span>, or the system is <strong>critically damped</strong>, the poles are:</p>
<p><span class="math display">\[s_{1, 2} = -\zeta \omega_n = - \sigma\]</span></p>
<p>We use a trick from differential equations to fake another linearly independent solution, just chuck on an extra <span class="math inline">\(t\)</span>.</p>
<p><span class="math display">\[q(t) = A_1 e^{-\zeta \omega_n t} + A_2 t e^{-\zeta \omega_n t} = A_1 e^{-\sigma t} + A_2 t e^{-\sigma t}\]</span></p>
<p>This doesn’t really happen in the real world, but it’s nice to cover all our bases - how about the case where <span class="math inline">\(\zeta &gt; 1\)</span>? The system is <strong>overdamped</strong> and our poles are:</p>
<p><span class="math display">\[s_{1, 2} = -\zeta \omega_n \pm \omega_n \sqrt{\zeta^2 - 1}\]</span></p>
<p>Both poles are negative here! Our solution is:</p>
<p><span class="math display">\[q(t) = A_1 e^{s_1 t} + A_2 e^{s_2 t}\]</span></p>
<p>Overdampedness implies that the mass can slowly return to equilibrium without ever overshooting as it would in the underdamped case.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/3_damp.png" class="img-fluid figure-img" style="width:65.0%"></p>
</figure>
</div>
</section>
<section id="leveraging-the-discriminant" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="leveraging-the-discriminant"><span class="header-section-number">3.2</span> Leveraging the Discriminant</h2>
<p>I’m going to stray off from Prof.&nbsp;Luchtenburg for a second because <em>I</em> think this is really useful.</p>
<p>Suppose we want to identify the dampedness of a system immediately based on the equation of motion rather than solving for <span class="math inline">\(\zeta\)</span>. We can do exactly this using the <strong>discriminant</strong> of the characteristic equation of the system. Let’s take a look at the canonical mass-spring system with a damper once again.</p>
<p>The equation of motion, assuming free motion, is: <span class="math display">\[m\ddot{q} + b \dot{q} + k q = 0\]</span></p>
<p>The characteristic equation is derived after plugging in <span class="math inline">\(q = e^{st}\)</span>. <span class="math display">\[ms^2 + bs + k = 0\]</span></p>
<p>As stated in the section on damping, there are three forms of the general solution if there is damping present: both poles are real and distinct (the system is overdamped), both poles are real and equal (the system is critically damped), or both poles are complex conjugates (the system is underdamped). You may recall from algebra that the discriminant of a polynomial can reveal some properties of the roots without having to compute them. The discriminant of a quadratic is defined as follows: <span class="math display">\[\text{Disc}(ax^2 + bx + c) = b^2-4ac\]</span></p>
<p>Notably, this is the argument of the square root in the quadratic formula. If this expression is positive, the solutions to the quadratic are real and distinct. If this expression is 0, then there is only one real solution to the quadratic. If this expression is negative, the solutions to the quadratic are complex. So physically, finding the discriminant of the characteristic equation of the mass-spring system will tell us how damped it is. <span class="math display">\[\text{Disc}(ms^2 + bs + k) = b^2-4mk\]</span></p>
<p><span class="math display">\[\begin{align*}
    b^2 - 4mk &gt; 0 \quad &amp;\to \quad \text{overdamped} \\
    b^2 - 4mk = 0 \quad &amp;\to \quad \text{critically damped} \\
    b^2 - 4mk &lt; 0 \quad &amp;\to \quad \text{underdamped}
\end{align*}\]</span></p>
<p>And of course, if <span class="math inline">\(b=0\)</span>, then the system is undamped.</p>
</section>
<section id="pole-plots" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="pole-plots"><span class="header-section-number">3.3</span> Pole Plots</h2>
<p>We use a graphical tool called a <strong>pole plot</strong>, the plot of the roots of the characteristic equation on the complex plane, to determine the dampedness of a system from its poles. Let’s go down the list:</p>
<ul>
<li>When both poles are on the imaginary axis, the system is undamped.</li>
<li>When both poles are off the real axis, the system oscillates. If they’re to the left of the imaginary axis, it’ll decay exponentially (underdamped), and if they’re to the right of the imaginary axis, it’ll grow exponentially.</li>
<li>If both poles are on the real axis to the left of the imaginary axis, it’s overdamped.</li>
<li>Rule of thumb: if there is ANY pole to the right of the imaginary axis, the response blows up.</li>
</ul>
<p>Here’s a nice chart from FPE. Complex conjugates are omitted for simplicity.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/3_pol.png" class="img-fluid figure-img" style="width:75.0%"></p>
</figure>
</div>
</section>
<section id="the-dominant-pole-approximation" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="the-dominant-pole-approximation"><span class="header-section-number">3.4</span> The Dominant Pole Approximation</h2>
<p>The concept of pole “speed” is often useful when analyzing higher order systems. While we’re able to gather valuable information from first and second order systems, doing this for systems of a higher order is more complicated.</p>
<p>A technique called the <strong>dominant pole approximation</strong> is applicable in these cases - namely, in the case that poles are substantially far apart, the slowest part of a system “dominates” the response and the faster parts are negligible for analysis.</p>
<p>It’s better to explain by showing rather than telling here. Say we’re provided with the following third order system (I don’t know, like hurricane wind):</p>
<p><span class="math display">\[ \frac{d^3 x}{dt^3} + 110.1 \frac{d^2 x}{dt^2} + 1011 \frac{d x}{dt} + 100x = u \]</span></p>
<p>The characteristic equation, expressed in terms of <span class="math inline">\(s\)</span>, is:</p>
<p><span class="math display">\[ s^3 + 110.1 s^2 + 1011 s + 100 = (s+0.1)(s+10)(s+100) = 0 \]</span></p>
<p>This equation has the roots <span class="math inline">\(-0.1\)</span>, <span class="math inline">\(-10\)</span>, and <span class="math inline">\(-100\)</span>. By definition, these are the poles of our system.</p>
<p>Poles closer to the origin (in this case, <span class="math inline">\(s=-0.1\)</span>) are considered <strong>slower</strong> than those farther away from the origin. This approximation poses that the slowest part of the system dominates the response, and that the effect of the faster poles can be ignored. (This is of course only the case if the gap between the slowest part of the system and the faster part(s) is large enough - this is, of course, just an approximation.)</p>
<p>Let’s continue with this problem. The slowest pole here is <span class="math inline">\(s=-0.1\)</span>, so we assume that the response to:</p>
<p><span class="math display">\[ \frac{d^3 x}{dt^3} + 110.1 \frac{d^2 x}{dt^2} + 1011 \frac{d x}{dt} + 100x = u \]</span></p>
<p>is similar to that of:</p>
<p><span class="math display">\[ 1000 \left( \frac{d x}{dt} + 0.1 x \right) = u \]</span></p>
<p>The scale factor of 1000 is necessary for the approximation - since we want the final value of the response to remain unchanged, we apply the additional condition that when all derivatives are zero, the original system and the approximation should be the same.<a href="#fn6" class="footnote-ref" id="fnref6" role="doc-noteref"><sup>6</sup></a></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/3_approx.png" class="img-fluid figure-img" style="width:85.0%"></p>
</figure>
</div>
<p>This approximation can also work for systems with complex poles - we can quantify a pole’s speed based on their real component.</p>
<p>Remember that this is just an approximation. There are times when it’s very cool and sleek to boot out a bunch of poles, but sometimes you’re losing valuable information about a system’s dynamic behavior. Prof.&nbsp;Fontaine says something that fits this situation pretty well in his Signal Processing class -</p>
<blockquote class="blockquote">
<p>Do no harm to the signal. Anything you do harms the signal. Sometimes the best option is to do nothing.</p>
</blockquote>
</section>
<section id="the-tank-revisited-inertia" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="the-tank-revisited-inertia"><span class="header-section-number">3.5</span> The Tank, Revisited (Inertia)</h2>
<p>Let’s revisit the tank from our study of first order systems. However, we’ll make one small change: the outflow pipe now has a defined length of <span class="math inline">\(L_p\)</span>.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/3_tank3.png" class="img-fluid figure-img" style="width:65.0%"></p>
</figure>
</div>
<p>We’ll model the same way we’ve been doing thus far. First, a conservation law:</p>
<p><span class="math display">\[\dot{V} = -Q\]</span></p>
<p>Next, “Ohm’s law”:</p>
<p><span class="math display">\[Q = \frac{\Delta P}{R} = \frac{P - P_\text{atm}}{R}\]</span></p>
<p>Let’s take a closer look at that pipe.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="figs/3_pipe.png" class="img-fluid figure-img" style="width:55.0%"></p>
</figure>
</div>
<p>Assuming the cross-sectional area of the pipe <span class="math inline">\(A_p\)</span> is constant, the pressure force <span class="math inline">\(F_p = A_p \Delta P\)</span> accelerates the fluid between the two ends of this pipe. Additionally, there is friction <span class="math inline">\(F_f = -QRA_p\)</span> on the liquid caused by the resistance of the pipe. By leveraging Newton’s second law of motion, we now have a relationship between the pressure difference <span class="math inline">\(\Delta P\)</span> and the velocity of the water <span class="math inline">\(v\)</span>.</p>
<p><span class="math display">\[m \frac{dv}{dt} = F_p + F_f = A_p \Delta P - Q R A_p\]</span></p>
<p>The mass <span class="math inline">\(m\)</span> of the fluid between the two ends of this pipe is equal to the product of the density of the fluid <span class="math inline">\(\rho\)</span> and the volume between the two ends <span class="math inline">\(V_p\)</span>. (Notably, the volume <span class="math inline">\(V_p = A_p L_p\)</span>.)</p>
<p><span class="math display">\[\rho \, V_p \, \frac{dv}{dt} = \rho A_p L_p \, \frac{dv}{dt} = A_p \Delta P - RQ A_p\]</span></p>
<p>Because the product of the cross-sectional area <span class="math inline">\(A_p\)</span> and the fluid velocity <span class="math inline">\(v\)</span> is equal to the volumetric flow rate <span class="math inline">\(Q\)</span>, we can rewrite this equation as follows:</p>
<p><span class="math display">\[\frac{\rho L_p}{A_p} \, \frac{dQ}{dt} = \Delta P - RQ\]</span></p>
<p>Ok, we can shed some light on what we’re doing now. We define <strong>inductance</strong> (also referred to as <strong>liquid-flow inertance</strong> or <strong>inertia</strong>) as a term that describes the change in potential required for a unit rate of fluid flow. Inductance is the tendency of the fluid to move; it’s created by the inertia of water flowing through the pipe. The mathematical definition of inductance is as follows:</p>
<p><span class="math display">\[L = \frac{\rho L_p}{A_p}\]</span></p>
<p>Note that this definition of inductance is only valid for flow systems, but analogous concepts occur in other fields (like inductors from circuit analysis)! Fluid components that have an inductance are analogous to these inductors, or mechanical components with inertia.</p>
<p>Let’s wrap up this example. When we plug in the definition of <span class="math inline">\(L\)</span> into our equation, a simple first order system rears its ugly head.<a href="#fn7" class="footnote-ref" id="fnref7" role="doc-noteref"><sup>7</sup></a></p>
<p><span class="math display">\[L \, \frac{dQ}{dt} + RQ = \Delta P\]</span></p>
<p>Let’s throw it into canonical form so we can see its time constant.</p>
<p><span class="math display">\[\left(\frac{L}{R}\right) \dot{Q} + Q = \frac{\Delta P}{R} \qquad \qquad \tau = \frac{L}{R}\]</span></p>
<p>To summarize, we’ve added a new tool to our arsenal: conservation of momentum (or Newton’s second law).</p>
<p><span class="math display">\[\Delta P = L \dot{Q} + RQ\]</span> <span class="math display">\[\dot{V} = -Q\]</span> <span class="math display">\[C \Delta P = V\]</span></p>
<p>By combining these three equations, we can use tools from our studies of mass-spring systems to analyze… well… any second order system.</p>
<p><span class="math display">\[L \Delta \ddot{P} + R \Delta \dot{P} + \frac{1}{C} \Delta P = 0 \qquad \to \qquad \Delta \ddot{P} + \left(\frac{R}{L}\right) \Delta \dot{P} + \left(\frac{1}{LC}\right) \Delta P = 0\]</span> <span class="math display">\[m \ddot{q} + b \dot{q} + k q = 0 \qquad \to \qquad \ddot{q} + \left(\frac{b}{m}\right) \dot{q} + \left(\frac{k}{m}\right) q = 0\]</span></p>
<p>We simply retrofit the definitions of the natural frequency <span class="math inline">\(\omega_n\)</span> and damping ratio <span class="math inline">\(\zeta\)</span> based on how we defined them for mass-spring systems to determine how the oscillations behave. Here’s a quick example using the flow system scenario we’ve been tackling thus far: <span class="math display">\[\ddot{q} + 2\zeta\omega_n \dot{q} + \omega_n^2 q = 0 \quad \longleftrightarrow \quad  \Delta \ddot{P} + \left(\frac{R}{L}\right) \Delta \dot{P} + \left(\frac{1}{LC}\right) \Delta P = 0\]</span></p>
<p><span class="math display">\[\begin{align*}
    2 \zeta \omega_n = \frac{R}{L} \qquad &amp;\longrightarrow \qquad \zeta = \frac{R}{2L \omega_n} = \frac{R\sqrt{LC}}{2L} = \frac{R}{2} \sqrt{\frac{C}{L}}\\
    \omega_n^2 = \frac{1}{LC} \qquad &amp;\longrightarrow \qquad \omega_n = \frac{1}{\sqrt{LC}} = \frac{\sqrt{LC}}{LC}
\end{align*}\]</span></p>


</section>
<section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes">
<hr>
<ol>
<li id="fn1"><p>Try to convince yourself of this mathematically just based on what oscillation is.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Prof.&nbsp;Baglione likes to comment that mathematicians use <span class="math inline">\(i\)</span> and engineers use <span class="math inline">\(j\)</span>, which is pretty funny. Usually, <span class="math inline">\(j\)</span> is used by electrical engineers for disambiguation with current, which is often represented with an <span class="math inline">\(i\)</span> as well.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn3"><p>You can prove this by substituting <span class="math inline">\(x = i \theta\)</span> into the Taylor series expansion of <span class="math inline">\(e^{x}\)</span>. Do it, it’s <em>very</em> rewarding.<a href="#fnref3" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn4"><p>Not sure if there’s an agreed upon name for this value, but I think that term covers the necessary bases.<a href="#fnref4" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn5"><p>This notation just means “on the order of”.<a href="#fnref5" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn6"><p>I’m really dancing around poles, transfer functions, and the Final Value Theorem here so I might write a follow-up section to this in Chapter 6 when we’ve developed the technology for it.<a href="#fnref6" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn7"><p>The analog of this system in circuit analysis is called the RL circuit, which is often used as a passive filter.<a href="#fnref7" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ch2.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">The First Order</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./ch4.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">An Engineering Student’s Butchering of Ma326</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>